apiVersion: objectbucket.io/v1alpha1
kind: ObjectBucketClaim
metadata:
  name: digital-forest-ugc
spec:
  bucketName: digital-forest-ugc
  storageClassName: rook-ceph-hasadna-bucket
  additionalConfig:
    maxObjects: "10000"
    maxSize: "5Gi"
    bucketPolicy: |
      {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::digital-forest-ugc/*"
          },
          {
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam:::user/digital-forest-ugc-uploader"
            },
            "Action": [
              "s3:GetBucketLocation",
              "s3:ListBucket",
              "s3:GetObject",
              "s3:PutObject"
            ],
            "Resource": [
              "arn:aws:s3:::digital-forest-ugc",
              "arn:aws:s3:::digital-forest-ugc/*"
            ]
          },
          {
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam:::user/digital-forest-ugc-object-admin"
            },
            "Action": [
              "s3:GetBucketLocation",
              "s3:ListBucket",
              "s3:GetObject",
              "s3:PutObject",
              "s3:DeleteObject"
            ],
            "Resource": [
              "arn:aws:s3:::digital-forest-ugc",
              "arn:aws:s3:::digital-forest-ugc/*"
            ]
          }
        ]
      }
---
apiVersion: ceph.rook.io/v1
kind: CephObjectStoreUser
metadata:
  name: digital-forest-ugc-uploader
spec:
  store: hasadna
  clusterNamespace: rook-ceph
---
apiVersion: ceph.rook.io/v1
kind: CephObjectStoreUser
metadata:
  name: digital-forest-ugc-object-admin
spec:
  store: hasadna
  clusterNamespace: rook-ceph
