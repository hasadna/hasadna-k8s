apiVersion: argoproj.io/v1alpha1
kind: WorkflowTemplate
metadata:
  name: runner
spec:
  arguments:
    parameters:
      - name: exec_script
        default: "ceph status"
  entrypoint: dag
  templates:
    - name: dag
      dag:
        tasks:
          - name: script
            template: script
            arguments:
              parameters:
                - name: exec_script
                  value: |
                    {{ "{{workflow.parameters.exec_script}}" }}
    - name: script
      serviceAccountName: workflow-runner
      inputs:
        parameters:
          - name: exec_script
      volumes: {{ include "runner.volumes" . | nindent 8 }}
      script: {{ include "runner.podSpec" . | nindent 8 }}
        {{ include "runner.workflowTemplateScriptSource" . | indent 8 }}
      outputs:
        parameters:
          - name: log
            valueFrom:
              path: /tmp/log.txt
